# 关于震颤卫士 (About Tremor Guard)

## 1. 项目背景与愿景 (Background & Vision)

### 1.1 痛点分析 (Problem Statement)
帕金森病（Parkinson's Disease, PD）作为全球第二大神经退行性疾病，其诊疗过程长期面临诸多挑战。
*   **主观性强**: 传统的UPDRS评分依赖医生的主观观察，缺乏量化的客观指标。
*   **数据孤岛**: 患者居家期间的数据（震颤频率、持续时间、发生时段）难以被记录，导致医生在复诊时难以通过瞬时的表现了解病情的真实全貌。
*   **医疗资源匮乏**: 专业神经内科医生资源稀缺，患者难以获得及时的健康指导。

### 1.2 项目愿景 (Project Vision)
**震颤卫士 (Tremor Guard)** 致力于构建一个 **"AI + IoT" 闭环健康管理生态**。我们通过可穿戴设备将不可见的震颤转化为可视化的数据，通过人工智能将专业的医疗知识转化为触手可及的健康服务，让每一位帕金森患者都能享受到客观、精准、温暖的守护。

---

## 2. 系统架构 (System Architecture)

本系统采用经典的物联网四层架构设计，实现了从数据采集到智能应用的完整闭环。

```mermaid
graph TD
    subgraph "感知层 (Perception)"
        ESP32[ESP32-C3 主控] -->|I2C| MPU[MPU6050 传感器]
        MPU -->|原始数据| ESP32
    end

    subgraph "网络层 (Network)"
        ESP32 -->|WiFi/MQTT| Gateway[API 网关]
    end

    subgraph "服务层 (Service)"
        Gateway -->|HTTP| FastAPI[后端服务 (FastAPI)]
        FastAPI -->|存储| DB[(PostgreSQL)]
        FastAPI -->|缓存| Redis[(Redis)]
        FastAPI -->|处理| Numpy[信号处理模块]
    end

    subgraph "AI 层 (Intelligence)"
        FastAPI <-->|API调用| LLM[Claude/GPT API]
        LLM <-->|检索| VectorDB[医疗知识库 (RAG)]
    end

    subgraph "应用层 (Application)"
        FastAPI -->|WebSocket/REST| Vue[前端 Web应用]
        Vue -->|展示| User[用户/医生]
    end
```

### 2.1 数据流向 (Data Flow)
1.  **采集**: MPU6050以125Hz频率采集手部三轴加速度与角速度。
2.  **传输**: ESP32-C3将打包后的数据通过WiFi即时发送至云端服务器。
3.  **分析**: 后端接收数据，利用FFT算法分析频谱，识别4-6Hz频段能量，判定是否为PD典型震颤。
4.  **解读**: 系统触发AI医生，结合分析结果与医疗知识库，生成健康简报。
5.  **展示**: 前端实时渲染波形图，并推送AI建议给用户。

---

## 3. 核心技术深度解析 (Technical Deep Dive)

### 3.1 硬件感知层 (Hardware & Embedded)
*   **主控芯片**: **ESP32-C3**
    *   *技术细节*: 基于RISC-V架构，主频160MHz。利用其内置的WiFi/BLE模块实现无线通信。固件中实现了**Deep Sleep**低功耗策略，在未检测到运动时自动休眠，极大延长续航。
*   **传感器**: **MPU6050 (6-Axis IMU)**
    *   *配置策略*:
        *   **采样率**: 设置为 **125Hz** (SMPLRT_DIV=7)。根据奈奎斯特采样定理，此频率足以精准还原帕金森病4-6Hz的震颤特征，同时避免过高采样带来的数据冗余。
        *   **低通滤波**: 启用片上DLPF (Digital Low Pass Filter)，带宽设为 **44Hz**，有效滤除高频肌电噪声与环境干扰。

### 3.2 信号处理算法 (Signal Processing)
*   **频谱分析 (Spectral Analysis)**:
    *   采用 **FFT (快速傅里叶变换)** 将时域信号转换为频域信号。
    *   **算法逻辑**: 计算加速度向量模长 -> 汉宁窗处理 (减少频谱泄漏) -> FFT变换 -> 提取功率谱密度 (PSD)。
    *   **判读标准**: 监测 **4-6Hz** 频段的能量占比。若该频段出现显著峰值且持续时间超过阈值，系统即判定为一次震颤事件。

### 3.3 后端服务层 (Backend Service)
*   **框架**: **FastAPI (Python)**
    *   *优势*: 依托Python强大的数据科学生态 (NumPy, SciPy)，无缝集成算法模块。全异步 (AsyncIO) 设计使其能轻松应对高并发的传感器数据流。
*   **数据库设计**:
    *   **PostgreSQL**: 存储用户画像、设备绑定关系及结构化的震颤事件（开始时间、持续时长、平均频率）。
    *   **Redis**: 作为消息队列缓冲实时数据流，并缓存热点数据（如当天的统计概览），降低数据库压力。

### 3.4 AI 医生 (AI Doctor & RAG)
*   **RAG (检索增强生成)**:
    *   解决了大模型在医疗领域的"幻觉"问题。
    *   *工作流*:
        1.  用户提问 ("我今天的震颤频率正常吗？")。
        2.  系统检索内置的 **《中国帕金森病治疗指南》** 及相关文献。
        3.  将检索到的权威医学知识 + 用户当日监测数据 + 用户提问，组装成Prompt。
        4.  LLM基于上下文生成准确、有依据的回答。
*   **系统提示词 (System Prompt)**:
    *   严格限定AI角色为"健康咨询助手"而非"执业医生"。
    *   强制包含免责声明 ("仅供参考，请咨询专业医生")。

### 3.5 前端交互层 (Frontend)
*   **技术栈**: **Vue 3 + Vite + Tailwind CSS**
*   **实时可视化**:
    *   利用 **WebSocket** 建立前后端长连接，实现毫秒级的数据推送。
    *   结合 **Chart.js** 和 **Canvas API** 绘制平滑的实时波形图，让用户直观看到"不可见"的身体信号。
    *   响应式设计确保了在PC端和移动端均有良好的访问体验。

---

## 4. 项目亮点 (Highlights)
1.  **客观量化**: 突破主观描述的局限，提供精确到Hz的震颤频率数据。
2.  **全时守护**: 居家场景下的7x24小时监测，填补了院外数据的空白。
3.  **普惠成本**: 硬件成本控制在百元级别，远低于专业的医疗级设备，利于大规模推广。
4.  **智能温情**: AI医生不仅提供冷冰冰的数据，更提供温暖的健康建议，缓解患者焦虑。

---

## 5. 未来展望 (Roadmap)
*   **V1.1**: 接入用药记录功能，分析"药物-震颤"相关性，辅助调药。
*   **V1.2**: 引入跌倒检测算法，增加异常报警功能。
*   **App版**: 开发基于Flutter的移动端App，提升便携性。

---

*Tremor Guard —— 科技向善，让爱无颤。*
